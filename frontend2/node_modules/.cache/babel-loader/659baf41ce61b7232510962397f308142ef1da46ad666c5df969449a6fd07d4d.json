{"ast":null,"code":"import React,{createContext,useState,useEffect}from'react';import axios from'axios';import{decodeToken}from'../utils/decodeToken';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();const axiosInstance=axios.create({baseURL:'http://localhost:3000'// Set your base URL here\n});const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{const token=localStorage.getItem('token');if(token){axiosInstance.defaults.headers.common['Authorization']=\"Bearer \".concat(token);try{const decodedToken=decodeToken(token);setUser({username:decodedToken.username});}catch(error){console.error('Invalid token:',error);logout();}}setLoading(false);},[]);const login=async(username,password)=>{try{const response=await axiosInstance.post('/api/auth/login',{username,password});const token=response.data.token;localStorage.setItem('token',token);axiosInstance.defaults.headers.common['Authorization']=\"Bearer \".concat(token);const decodedToken=decodeToken(token);setUser({username:decodedToken.username});}catch(error){console.error('Login error:',error);throw error;}};const register=async(username,password)=>{try{await axiosInstance.post('/api/auth/register',{username,password});}catch(error){console.error('Registration error:',error);throw error;}};const logout=()=>{localStorage.removeItem('token');delete axiosInstance.defaults.headers.common['Authorization'];setUser(null);};const fetchCalendarEntries=async()=>{if(!axiosInstance.defaults.headers.common['Authorization']){const token=localStorage.getItem('token');if(token){axiosInstance.defaults.headers.common['Authorization']=\"Bearer \".concat(token);}else{throw new Error('No token, authorization denied');}}try{const response=await axiosInstance.get('/api/calendar/entries');return response.data;}catch(error){if(error.message.includes('blocked by CORS policy')){console.warn('Request blocked by CORS policy, ignoring:',error);return[];// Return an empty array or a default value\n}else if(error.response&&error.response.status===401){console.error('Authorization error:',error.response);// Handle unauthorized access\nreturn[];}else{console.error('Error fetching calendar entries:',error);throw error;}}};const addCalendarEntry=async entry=>{try{const response=await axiosInstance.post('/api/calendar/entries',entry);return response.data;}catch(error){if(error.message.includes('blocked by CORS policy')){console.warn('Request blocked by CORS policy, ignoring:',error);return null;// Return a default value or null\n}else{console.error('Error adding calendar entry:',error);throw error;}}};const updateCalendarEntry=async(id,entry)=>{try{const response=await axiosInstance.put(\"/api/calendar/entries/\".concat(id),entry);return response.data;}catch(error){if(error.message.includes('blocked by CORS policy')){console.warn('Request blocked by CORS policy, ignoring:',error);return null;// Return a default value or null\n}else{console.error('Error updating calendar entry:',error);throw error;}}};const deleteCalendarEntry=async id=>{try{const response=await axiosInstance.delete(\"/api/calendar/entries/\".concat(id));return response.data;}catch(error){if(error.message.includes('blocked by CORS policy')){console.warn('Request blocked by CORS policy, ignoring:',error);return null;// Return a default value or null\n}else{console.error('Error deleting calendar entry:',error);throw error;}}};if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,login,register,logout,fetchCalendarEntries,addCalendarEntry,updateCalendarEntry,deleteCalendarEntry},children:children});};export{AuthContext,AuthProvider};","map":{"version":3,"names":["React","createContext","useState","useEffect","axios","decodeToken","jsx","_jsx","AuthContext","axiosInstance","create","baseURL","AuthProvider","_ref","children","user","setUser","loading","setLoading","token","localStorage","getItem","defaults","headers","common","concat","decodedToken","username","error","console","logout","login","password","response","post","data","setItem","register","removeItem","fetchCalendarEntries","Error","get","message","includes","warn","status","addCalendarEntry","entry","updateCalendarEntry","id","put","deleteCalendarEntry","delete","Provider","value"],"sources":["/Users/06mali01/WebstormProjects/workoutproject/frontend/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { decodeToken } from '../utils/decodeToken';\n\nconst AuthContext = createContext();\n\nconst axiosInstance = axios.create({\n    baseURL: 'http://localhost:3000', // Set your base URL here\n});\n\nconst AuthProvider = ({ children }) => {\n    const [user, setUser] = useState(null);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        const token = localStorage.getItem('token');\n        if (token) {\n            axiosInstance.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n            try {\n                const decodedToken = decodeToken(token);\n                setUser({ username: decodedToken.username });\n            } catch (error) {\n                console.error('Invalid token:', error);\n                logout();\n            }\n        }\n        setLoading(false);\n    }, []);\n\n    const login = async (username, password) => {\n        try {\n            const response = await axiosInstance.post('/api/auth/login', { username, password });\n            const token = response.data.token;\n            localStorage.setItem('token', token);\n            axiosInstance.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n            const decodedToken = decodeToken(token);\n            setUser({ username: decodedToken.username });\n        } catch (error) {\n            console.error('Login error:', error);\n            throw error;\n        }\n    };\n\n    const register = async (username, password) => {\n        try {\n            await axiosInstance.post('/api/auth/register', { username, password });\n        } catch (error) {\n            console.error('Registration error:', error);\n            throw error;\n        }\n    };\n\n    const logout = () => {\n        localStorage.removeItem('token');\n        delete axiosInstance.defaults.headers.common['Authorization'];\n        setUser(null);\n    };\n\n    const fetchCalendarEntries = async () => {\n        if (!axiosInstance.defaults.headers.common['Authorization']) {\n            const token = localStorage.getItem('token');\n            if (token) {\n                axiosInstance.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n            } else {\n                throw new Error('No token, authorization denied');\n            }\n        }\n        try {\n            const response = await axiosInstance.get('/api/calendar/entries');\n            return response.data;\n        } catch (error) {\n            if (error.message.includes('blocked by CORS policy')) {\n                console.warn('Request blocked by CORS policy, ignoring:', error);\n                return []; // Return an empty array or a default value\n            } else if (error.response && error.response.status === 401) {\n                console.error('Authorization error:', error.response);\n                // Handle unauthorized access\n                return [];\n            } else {\n                console.error('Error fetching calendar entries:', error);\n                throw error;\n            }\n        }\n    };\n\n    const addCalendarEntry = async (entry) => {\n        try {\n            const response = await axiosInstance.post('/api/calendar/entries', entry);\n            return response.data;\n        } catch (error) {\n            if (error.message.includes('blocked by CORS policy')) {\n                console.warn('Request blocked by CORS policy, ignoring:', error);\n                return null; // Return a default value or null\n            } else {\n                console.error('Error adding calendar entry:', error);\n                throw error;\n            }\n        }\n    };\n\n    const updateCalendarEntry = async (id, entry) => {\n        try {\n            const response = await axiosInstance.put(`/api/calendar/entries/${id}`, entry);\n            return response.data;\n        } catch (error) {\n            if (error.message.includes('blocked by CORS policy')) {\n                console.warn('Request blocked by CORS policy, ignoring:', error);\n                return null; // Return a default value or null\n            } else {\n                console.error('Error updating calendar entry:', error);\n                throw error;\n            }\n        }\n    };\n\n    const deleteCalendarEntry = async (id) => {\n        try {\n            const response = await axiosInstance.delete(`/api/calendar/entries/${id}`);\n            return response.data;\n        } catch (error) {\n            if (error.message.includes('blocked by CORS policy')) {\n                console.warn('Request blocked by CORS policy, ignoring:', error);\n                return null; // Return a default value or null\n            } else {\n                console.error('Error deleting calendar entry:', error);\n                throw error;\n            }\n        }\n    };\n\n    if (loading) {\n        return <div>Loading...</div>;\n    }\n\n    return (\n        <AuthContext.Provider value={{ user, login, register, logout, fetchCalendarEntries, addCalendarEntry, updateCalendarEntry, deleteCalendarEntry }}>\n            {children}\n        </AuthContext.Provider>\n    );\n};\n\nexport { AuthContext, AuthProvider };"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}